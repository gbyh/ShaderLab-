## 表面着色器语法

在Unity所有着色器文件都写在一个声明称为ShaderLab语言”。在文件中，一个嵌套的括号语法声明各种事物描述着色器–例如的着色器性能应在材料检验证明；什么样的硬件特点做；什么样的混合模式的使用等；实际“着色器代码”就是写的CGPROGRAM片段在同一着色器文件（见表着色和顶点和片段着色器）。

这页和子页介绍了嵌套的括号“ShaderLab语法。的CGPROGRAM片断定期书面HLSL / CG着色语言，看到他们的文档的页面。

Shader是一个着色文件的根命令。每个文件必须定义一个（和唯一一个）。它指定了材质使用该着色器的对象是如何呈现的.。

#### 语法：

```
Shader "name" { [Properties] Subshaders [Fallback] [CustomEditor] }
```

#### 细节

##### Properties

着色器可以有一个属性列表。在着色器中声明的任何属性都显示在Unity内部的检视面板中。典型的属性是对象颜色，纹理，或者只是由着色器使用的任意值。

##### SubShaders & Fallback

着色器包含一系列的子着色器。你必须至少有一个。当加载一个着色器，Unity将通过着色器的列表，并选择第一个，是由最终用户的机器支持。如果没有子着色器的支持，Unity将尝试使用备用着色器。

不同的显卡有不同的功能。这为游戏开发者提出了一个永恒的问题：你希望你的游戏在最新的硬件上看起来很棒，但不希望它只对3%的人有用。这是着色器来。创建一个着色器，所有花哨的图形效果你可以梦想，然后增加老年卡多着色器。这些着色器可以实现你想要在一个缓慢的影响，或者他们可以选择不执行的一些细节。

着色器”层次细节（LOD）和“着色”替代“两种技术，也是建立在着色器，详情请参阅着色器LOD和着色器replacemement。

##### Examples

Here is one of the simplest shaders possible:

```
// colored vertex lighting
Shader "Simple colored lighting"
{
    // a single color property
    Properties {
        _Color ("Main Color", Color) = (1,.5,.5,1)
    }
    // define one subshader
    SubShader
    {
        // a single pass in our subshader
        Pass
        {
            // use fixed function per-vertex lighting
            Material
            {
                Diffuse [_Color]
            }
            Lighting On
        }
    }
}
```

这个着色器定义颜色属性\_color（显示在材料检验为主要颜色）用默认值（1,0.5,0.5,1）。然后一个单一的SubShader  
定义。该着色器包含一个通过打开固定功能顶点照明和设置了它的基本材质。

### 语法

```
#pragma surface <表面着色器函数名> <光照模型> [可选参数]



光照模型：

      Lambert / Blinnphong



可选参数：(:前后不加空格)

    alpha --- alpha:auto 将褪色的透明度（同alpha:fade）简单的照明功能，并进行透明（同alpha:premul）基于物理的照明功能。
              alpha:fade 褪色     alpha:premul 启用自左乘alpha透明度

    alphatest --- alphatest:变量名

    decal --- 添加贴花材质（如地形AddPass）。这意味着对象躺在其他表面，并使用参数设置混合。 decal:add     decal:blend

    vertex --- vertex:VertexFunction 自定义顶点修改功能。这个函数调用生成的顶点着色器，和修改或计算每个顶点的数据。
        举例： void vert(inout appdata_full v){}
              void vert(inout appdata_full v, out Input o)
              {
                  UNITY_INITIALIZE_OUTPUT(Input, o);
                  // ...
              }
                
    finalcolor --- finalcolor:ColorFunction 定制的最终颜色修改功能。
        举例： void mycolor(Input IN, SurfaceOutput o, out fixed4 o)
        {
            color *= _ColorTint;
        }
        
    其他可选参数：
    addshadow --- 生成一给影子。常用于自定义顶点修改。
    fullforwardshadows -- 支持渲染路径中的所有光影类型。默认情况下在前向渲染只支持一个平行光的阴影。如果你需要点光源阴影的渲染，可以使用这个指令。
    
    
    标准表面着色器结构
    
    struct SurfaceOutput
    {
        half3 Albedo;    // 反射率，就是纹理颜色值（RGB）
        half3 Normal;    // 法线，法向量（xyz）
        half3 Emission;    // 自发光颜色值（RGB）
        half Specular;    // 镜面反射度
        fixed Gloss;    // 光泽度
        fixed Alpha;    // 透明度
    };
    
    Unity5中内置的Standard和StandardSpecular 使用的结构
    
    struct SurfaceOutputStandard
    {
        fixed3 Albedo;
        fixed3 Normal;
        fixed3 Emission;
        half Metallic;
        half Smoothness;
        half Occlusion;
        half Alpha;
    };
    
    struct SurfaceOutputStandardSpecular
    {
        fixed3 Albedo;
        fixed3 Specular;
        fixed3 Normal;
        fixed3 Emission;
        half Smoothness;
        half Occlusion;
        fixed Alpha;
    };
    
```

🔚

