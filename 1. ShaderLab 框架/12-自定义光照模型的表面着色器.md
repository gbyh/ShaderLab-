##自定义光照模型的表面着色器

When writing Surface Shaders, you’re describing properties of a surface (albedo color, normal, …) and the lighting interaction is computed by a Lighting Model. Built-in lighting models are Lambert (diffuse lighting) and BlinnPhong (specular lighting).
写作时表面着色器,你描述一个表面的性质(反照率的颜色,正常,…)和照明的照明计算交互模型。内置照明模型是兰伯特(漫射照明)和BlinnPhong(镜面照明)。

Sometimes you might want to use a custom lighting model, and it is possible to do that in Surface Shaders. Lighting model is nothing more than a couple of Cg/HLSL functions that match some conventions. The built-in Lambert and BlinnPhong models are defined in Lighting.cginc file inside Unity ({unity install path}/Data/CGIncludes/Lighting.cginc on Windows, /Applications/Unity/Unity.app/Contents/CGIncludes/Lighting.cginc on Mac).
有时你可能想要使用一个定制的照明模式,并有可能在表面着色器。照明模型只不过是几个Cg / HLSL函数相匹配的一些约定。内置的兰伯特和BlinnPhong模型中定义照明。cginc文件内部Unity({Unity安装路径} /数据/ CGIncludes /照明。cginc在Windows上,/应用程序/团结/ Unity.app /内容/ CGIncludes /照明。cginc Mac)。

Lighting Model declaration
照明模型声明

Lighting model is a couple of regular functions with names starting with Lighting. They can be declared anywhere in your shader file or one of included files. The functions are:
照明模型是两个正则函数的名字从照明开始。他们可以在声明你的材质文件或包含文件之一。功能有:

	1	half4 Lighting<Name> (SurfaceOutput s, half3 lightDir, half atten); 
		This is used in forward rendering path for light models that are not view direction dependent (e.g. diffuse).
		这是光用于转发渲染路径模型不依赖视图方向(如扩散)。
	2	half4 Lighting<Name> (SurfaceOutput s, half3 lightDir, half3 viewDir, half atten); 
		This is used in forward rendering path for light models that are view direction dependent.
		这是光用于转发渲染路径依赖模型,视图方向。
	3	half4 Lighting<Name>_PrePass (SurfaceOutput s, half4 light); 
		This is used in deferred lighting path.
		这是用于延迟照明道路。

Note that you don’t need to declare all functions. A lighting model either uses view direction or it does not. Similarly, if the lighting model will not work in deferred lighting, you just do not declare _PrePass function, and all shaders that use it will compile to forward rendering only.
请注意,您不需要声明所有功能。照明模型使用视图方向或不。类似地,如果照明模型不会在延迟工作照明,你不只是声明_PrePass函数,所有着色器使用它只编译前呈现。

Decoding Lightmaps
解码光照贴图

Decoding lightmap data can be customized in a similar fashion as the lighting function for forward and deferred lighting. Use one of the functions below depending on whether your light model is view direction dependent or not. To decode standard Unity lightmap texture data (passed in color, totalColor, indirectOnlyColor and scale arguments) use built-in DecodeLightmap function.
解码lightmap数据可以被定制以类似的方式作为前锋和递延照明的照明功能。下面的函数使用一个取决于你的光模型视图方向依赖。解码标准统一lightmap纹理数据(通过颜色、totalColor indirectOnlyColor和规模参数)使用内置DecodeLightmap函数。

Custom lightmap decoding functions handle forward and deferred lighting rendering paths automatically. However you must be aware that in deferred case Lighting<Name>_PrePass function will be called after lightmap decoding and light argument will contain sum of realtime lighting and lightmaps. If necessary you can distinguish forward and deferred paths by using built-in UNITY_PASS_PREPASSFINAL macro.
定制lightmap解码函数处理,自动延期照明渲染路径。但是你必须意识到,在延迟情况下照明<名称> _PrePass函数将称光lightmap解码后,参数将包含实时照明和以及材质。如果有必要你可以区分向前和延迟路径通过使用内置UNITY_PASS_PREPASSFINAL宏。

Functions to customize decoding of Single lightmaps are:
功能定制解码以及材质单是:
	1	half4 Lighting<Name>_SingleLightmap (SurfaceOutput s, fixed4 color); 
		This is used for light models that are not view direction dependent (e.g. diffuse).
		这是用于光模型不依赖视图方向(如扩散)。
	2	half4 Lighting<Name>_SingleLightmap (SurfaceOutput s, fixed4 color, half3 viewDir); 
		This is used for light models that are view direction dependent.
		这是用于光模型视图方向相关的。

Functions to customize decoding of Dual lightmaps are:
功能定制解码双重以及材质有:
	1	half4 Lighting<Name>_DualLightmap (SurfaceOutput s, fixed4 totalColor, fixed4 indirectOnlyColor, half indirectFade); 
		This is used for light models that are not view direction dependent (e.g. diffuse).
		这是用于光模型不依赖视图方向(如扩散)。
	2	half4 Lighting<Name>_DualLightmap (SurfaceOutput s, fixed4 totalColor, fixed4 indirectOnlyColor, half indirectFade, half3 viewDir); 
		This is used for light models that are view direction dependent.
	这是用于光模型视图方向相关的。

Functions to customize decoding of Directional lightmaps are:
功能定制定向的解码以及材质有:
	1	half4 Lighting<Name>_DirLightmap (SurfaceOutput s, fixed4 color, fixed4 scale, bool surfFuncWritesNormal); 
		This is used for light models that are not view direction dependent (e.g. diffuse).
		这是用于光模型不依赖视图方向(如扩散)。
	2	half4 Lighting<Name>_DirLightmap (SurfaceOutput s, fixed4 color, fixed4 scale, half3 viewDir, bool surfFuncWritesNormal, out half3 specColor); 
		This is used for light models that are view direction dependent.
		这是用于光模型视图方向相关的。